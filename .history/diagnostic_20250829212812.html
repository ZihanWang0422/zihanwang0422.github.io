<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>返回顶部按钮诊断</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        
        .diagnostic-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            z-index: 1001;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            max-width: 300px;
        }
        
        .status {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        
        .status.good { background: #d4edda; color: #155724; }
        .status.bad { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        
        .content {
            height: 1500px;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            margin: 20px;
            padding: 20px;
            border-radius: 8px;
        }
        
        /* 返回顶部按钮 - 完全相同的样式 */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .back-to-top:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .test-buttons {
            margin: 10px 0;
        }
        
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 12px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .test-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="diagnostic-panel">
        <h3>🔍 返回顶部按钮诊断</h3>
        
        <div id="buttonExists" class="status">检查按钮元素...</div>
        <div id="fontAwesome" class="status">检查Font Awesome...</div>
        <div id="scrollPosition" class="status">滚动位置: 0px</div>
        <div id="buttonStatus" class="status">按钮状态: 检查中...</div>
        
        <div class="test-buttons">
            <button class="test-btn" onclick="forceShowButton()">强制显示</button>
            <button class="test-btn" onclick="testScroll()">测试滚动</button>
            <button class="test-btn" onclick="inspectButton()">检查元素</button>
        </div>
        
        <small>刷新页面重新检测</small>
    </div>
    
    <div class="content">
        <h1>诊断页面</h1>
        <p>这个页面用来诊断返回顶部按钮的问题。</p>
        
        <h2>检查列表:</h2>
        <ol>
            <li>按钮HTML元素是否存在</li>
            <li>Font Awesome图标库是否加载</li>
            <li>CSS样式是否正确应用</li>
            <li>JavaScript事件是否正常工作</li>
        </ol>
        
        <p>向下滚动超过100px，按钮应该自动显示。</p>
        
        <h2>手动测试</h2>
        <p>使用左上角的诊断面板中的按钮进行测试。</p>
        
        <div style="height: 500px; background: rgba(0,0,0,0.1); margin: 20px 0; padding: 20px;">
            <h3>继续滚动...</h3>
            <p>当滚动位置超过100px时，右下角应该出现紫色渐变的圆形按钮。</p>
        </div>
        
        <div style="height: 500px; background: rgba(0,0,0,0.05); margin: 20px 0; padding: 20px;">
            <h3>更多内容</h3>
            <p>如果按钮还是不显示，请查看左上角的诊断信息。</p>
        </div>
    </div>

    <!-- 返回顶部按钮 -->
    <button class="back-to-top" id="backToTop">
        <i class="fa fa-arrow-up"></i>
    </button>

    <script>
        let backToTopButton;
        
        document.addEventListener('DOMContentLoaded', function() {
            backToTopButton = document.getElementById('backToTop');
            
            // 检查按钮是否存在
            const buttonExistsEl = document.getElementById('buttonExists');
            if (backToTopButton) {
                buttonExistsEl.textContent = '✅ 按钮元素存在';
                buttonExistsEl.className = 'status good';
            } else {
                buttonExistsEl.textContent = '❌ 按钮元素不存在';
                buttonExistsEl.className = 'status bad';
                return;
            }
            
            // 检查Font Awesome
            const fontAwesomeEl = document.getElementById('fontAwesome');
            const testIcon = document.createElement('i');
            testIcon.className = 'fa fa-arrow-up';
            testIcon.style.visibility = 'hidden';
            document.body.appendChild(testIcon);
            
            setTimeout(() => {
                const computedStyle = window.getComputedStyle(testIcon);
                if (computedStyle.fontFamily.includes('FontAwesome') || 
                    computedStyle.fontFamily.includes('Font Awesome')) {
                    fontAwesomeEl.textContent = '✅ Font Awesome已加载';
                    fontAwesomeEl.className = 'status good';
                } else {
                    fontAwesomeEl.textContent = '⚠️ Font Awesome可能未加载';
                    fontAwesomeEl.className = 'status warning';
                }
                document.body.removeChild(testIcon);
            }, 100);
            
            // 滚动事件监听
            function updateStatus() {
                const scrollPos = window.pageYOffset;
                const scrollEl = document.getElementById('scrollPosition');
                const statusEl = document.getElementById('buttonStatus');
                
                scrollEl.textContent = `滚动位置: ${scrollPos}px`;
                
                if (scrollPos > 100) {
                    backToTopButton.classList.add('show');
                    statusEl.textContent = '✅ 按钮应该显示';
                    statusEl.className = 'status good';
                } else {
                    backToTopButton.classList.remove('show');
                    statusEl.textContent = '⏸️ 按钮隐藏（滚动<100px）';
                    statusEl.className = 'status warning';
                }
            }
            
            window.addEventListener('scroll', updateStatus);
            updateStatus();
            
            // 点击事件
            backToTopButton.addEventListener('click', function() {
                console.log('返回顶部按钮被点击');
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        });
        
        // 测试函数
        function forceShowButton() {
            if (backToTopButton) {
                backToTopButton.style.opacity = '1';
                backToTopButton.style.visibility = 'visible';
                backToTopButton.style.transform = 'translateY(0)';
                backToTopButton.style.background = 'red';
                alert('按钮已强制显示（红色）。如果你看不到，说明有CSS冲突或其他问题。');
            }
        }
        
        function testScroll() {
            window.scrollTo({ top: 200, behavior: 'smooth' });
            setTimeout(() => {
                alert('已滚动到200px位置，按钮应该显示');
            }, 500);
        }
        
        function inspectButton() {
            if (backToTopButton) {
                const rect = backToTopButton.getBoundingClientRect();
                const styles = window.getComputedStyle(backToTopButton);
                const info = `
按钮位置: ${rect.left}px, ${rect.top}px
按钮大小: ${rect.width}px × ${rect.height}px
透明度: ${styles.opacity}
可见性: ${styles.visibility}
层级: ${styles.zIndex}
位置: ${styles.position}
                `.trim();
                alert(info);
                console.log('按钮详细信息:', {
                    element: backToTopButton,
                    rect: rect,
                    styles: styles
                });
            }
        }
    </script>
</body>
</html>
